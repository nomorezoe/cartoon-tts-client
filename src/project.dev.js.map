{"version":3,"sources":["assets/Scripts/game/Ballon.js","assets/Scripts/game/BodyAnim.js","assets/Scripts/game/CamAdjust.js","assets/Scripts/game/CamMove.js","assets/Scripts/game/Eye.js","assets/Scripts/game/Game.js","assets/Scripts/loading/Loading.js","assets/Scripts/game/MusicToggle.js"],"names":["cc","Class","extends","Component","properties","whiteBG","Node","pinkBG","text","Label","start","update","this","updateTextHeight","node","height","bg","Math","max","init","isFurwee","color","Color","active","string","step","x","opacity","parent","removeChild","BodyAnim","anim","Animation","playIntro","play","introComplete","CamAdjust","cameras","Camera","isKeyA","isKeyD","isKeyW","isKeyS","isKeyO","isKeyP","isK","isL","isM","isN","statics","onLoad","systemEvent","on","SystemEvent","EventType","KEY_DOWN","onKeyDown","KEY_UP","onKeyUp","onDestroy","off","i","length","z","_i","_i2","y","_i3","_i4","_i5","_i6","rotationX","_i7","_i8","fov","_i9","event","keyCode","macro","KEY","a","d","w","s","o","p","k","l","m","n","u","console","log","position","sceneNodes","infos","vx","vy","ax","maxV","rotRangeX","rotRangeY","screenWidth","screenHeight","designResolutionHeight","designResolutionHeight_2","view","getDesignResolutionSize","getCanvasSize","width","info","eulerAngles","push","TOUCH_MOVE","onTouchMove","MOUSE_MOVE","onMouseMove","evt","targetY","_x","targetX","_y","currentX","currentY","timeY","abs","timeX","rotate3DTo","v3","stopAllActions","runAction","stage","eye","isLeft","Boolean","randX","randY","touchMoveHandler","mouseMoveHandler","worldPos","convertToWorldSpaceAR","v2","getLocationX","getLocationY","pos","convertToNodeSpaceAR","len","tan","ctan","posX","posY","mouseLen2","pow","factor","min","len2","setPosition","MusicToggle","require","editBox","EditBox","audioID","mouthNode","mouthIsReset","historyObjects","sendButton","balloonPrefab","Prefab","balloonNode","introSound","type","AudioClip","default","music","blockerNode","idleMouthTimeout","bodyAnim","headAnim","initialMsgJSON","introCameras","furweeIntialized","URL","isLocalHost","window","location","href","indexOf","onTextLenChange","startFurwee","handleConnect","socket","id","startFurwee_backup","msg","addBallon","audioInfo","audio_offset_ms","viseme_id","audioEngine","audioOffset","updateMouth","setFinishCallback","bind","that","xhr","XMLHttpRequest","requestURL","onreadystatechange","readyState","DONE","status","JSON","parse","responseText","tryToStartFurweeIntro","remoteUrl","audio_file_link","loader","load","url","open","setRequestHeader","send","onTTSCompleted","reply","index","message","soundloadedHandler","arguments","undefined","lip_sync_animation","err","res","stopIdleMouth","didReturnHandler","sendHandler","setTimeout","focus","sendText","trim","json","params","stringify","history","xhr2","requestURL2","params2","getChildByName","clearMouth","dt","time","getCurrentTime","startIdleMouth","textContent","children","getComponent","balloon","instantiate","addChild","blockClickHandler","initialize","introCameraAnim","node2","_node","setIdleMouth","clearTimeout","idle","floor","random","progressBar","ProgressBar","director","preloadScene","onProgress","onComplete","completedCount","totalCount","progress","error","loadScene","onNode","offNode","hintNode","hintText","audioId","isMusicOn","sys","localStorage","getItem","toggleOn","toggleOff","toggleOver","toggleOut","pauseMusic","resumeMusic","playMusic"],"mappings":"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","sourcesContent":["// Learn cc.Class:\n//  - https://docs.cocos.com/creator/manual/en/scripting/class.html\n// Learn Attribute:\n//  - https://docs.cocos.com/creator/manual/en/scripting/reference/attributes.html\n// Learn life-cycle callbacks:\n//  - https://docs.cocos.com/creator/manual/en/scripting/life-cycle-callbacks.html\n\ncc.Class({\n    extends: cc.Component,\n\n    properties: {\n        whiteBG: cc.Node,\n        pinkBG: cc.Node,\n        text: cc.Label,\n    },\n\n    // LIFE-CYCLE CALLBACKS:\n\n    // onLoad () {},\n\n    start() {\n\n    },\n\n    // update (dt) {},\n\n    update() {\n        if (this.updateTextHeight) {\n            this.node.height = this.bg.height = Math.max(55, this.text.node.height + 20);\n            this.updateTextHeight = false;\n        }\n    },\n\n    init(text, isFurwee) {\n\n        if (isFurwee) {\n            this.text.node.color = new cc.Color(\"#63697B\");\n            this.pinkBG.active = false;\n            this.whiteBG.active = true;\n\n            this.bg = this.whiteBG;\n        }\n        else {\n            this.text.node.color = new cc.Color(\"#FFFFFF\");\n            this.whiteBG.active = false;\n            this.pinkBG.active = true;\n\n            this.bg = this.pinkBG;\n        }\n        this.isFurwee = isFurwee;\n        this.text.string = text;\n        this.updateTextHeight = true;\n\n    },\n\n    step() {\n        if (this.isFurwee) {\n            this.node.x -= 20;\n        }\n        else {\n            this.node.x += 20;\n        }\n\n        this.node.opacity -= 50;\n\n        if(this.node.opacity <=0){\n            this.node.parent.removeChild(this.node);\n        }\n    },\n\n\n});\n","// Learn cc.Class:\n//  - https://docs.cocos.com/creator/manual/en/scripting/class.html\n// Learn Attribute:\n//  - https://docs.cocos.com/creator/manual/en/scripting/reference/attributes.html\n// Learn life-cycle callbacks:\n//  - https://docs.cocos.com/creator/manual/en/scripting/life-cycle-callbacks.html\n\nlet BodyAnim = cc.Class({\n    extends: cc.Component,\n\n    properties: {\n        anim: cc.Animation\n        // foo: {\n        //     // ATTRIBUTES:\n        //     default: null,        // The default value will be used only when the component attaching\n        //                           // to a node for the first time\n        //     type: cc.SpriteFrame, // optional, default is typeof default\n        //     serializable: true,   // optional, default is true\n        // },\n        // bar: {\n        //     get () {\n        //         return this._bar;\n        //     },\n        //     set (value) {\n        //         this._bar = value;\n        //     }\n        // },\n    },\n\n    // LIFE-CYCLE CALLBACKS:\n\n    // onLoad () {},\n\n    start () {\n\n    },\n\n    playIntro(){\n        this.anim.play(\"intro_body\");\n    },\n\n    introComplete(){\n        this.anim.play(\"body\");\n    },\n\n    play(){\n        this.anim.play(\"body\");\n    }\n    // update (dt) {},\n});\n","let CamAdjust = cc.Class({\n    extends: cc.Component,\n\n    properties:{\n        cameras: [cc.Camera],\n\n        isKeyA:false,\n        isKeyD:false,\n        isKeyW:false,\n        isKeyS:false,\n\n        isKeyO:false,\n        isKeyP:false,\n\n        isK:false,\n        isL:false,\n\n        isM:false,\n        isN:false\n       \n    },\n\n    statics:{\n    },\n\n    onLoad: function(){\n\n       cc.systemEvent.on(cc.SystemEvent.EventType.KEY_DOWN, this.onKeyDown, this);\n       cc.systemEvent.on(cc.SystemEvent.EventType.KEY_UP, this.onKeyUp, this);\n    },\n\n    onDestroy: function(){\n       cc.systemEvent.off(cc.SystemEvent.EventType.KEY_DOWN, this.onKeyDown, this);\n       cc.systemEvent.off(cc.SystemEvent.EventType.KEY_UP, this.onKeyUp, this);\n    },\n\n    update: function(){\n\n        if(this.isKeyA){\n            for(let i = 0; i < this.cameras.length; i ++){\n                this.cameras[i].node.z +=1;\n             }\n        }\n\n        if(this.isKeyD){\n            for(let i = 0; i < this.cameras.length; i ++){\n                this.cameras[i].node.z -=1;\n             }\n        }\n\n        if(this.isKeyW){\n            for(let i = 0; i < this.cameras.length; i ++){\n                this.cameras[i].node.y +=1;\n             }\n        }\n\n        if(this.isKeyS){\n            for(let i = 0; i < this.cameras.length; i ++){\n                this.cameras[i].node.y -=1;\n             }\n        }\n\n         if(this.isM){\n            for(let i = 0; i < this.cameras.length; i ++){\n                this.cameras[i].node.x +=1;\n             }\n        }\n\n         if(this.isN){\n            for(let i = 0; i < this.cameras.length; i ++){\n                this.cameras[i].node.x -=1;\n             }\n        }\n\n        if(this.isKeyO){\n            for(let i = 0; i < this.cameras.length; i ++){\n                this.cameras[i].node.rotationX +=0.1;\n             }\n        }\n\n        if(this.isKeyP){\n            for(let i = 0; i < this.cameras.length; i ++){\n                this.cameras[i].node.rotationX -=0.1;\n             }\n        }\n\n        if(this.isK){\n            for(let i = 0; i < this.cameras.length; i ++){\n                this.cameras[i].fov +=0.1;\n             }\n        }\n\n        if(this.isL){\n            for(let i = 0; i < this.cameras.length; i ++){\n                this.cameras[i].fov -=0.1;\n             }\n        }\n    },\n\n    onKeyDown: function (event) {\n        switch(event.keyCode) {\n            case cc.macro.KEY.a:\n                this.isKeyA = true;\n                break;\n            case cc.macro.KEY.d:\n                this.isKeyD = true;\n                break;\n            case cc.macro.KEY.w:\n                this.isKeyW = true;\n                break;\n            case cc.macro.KEY.s:\n                this.isKeyS = true;\n                break;\n            case cc.macro.KEY.o:\n                this.isKeyO = true;\n                break;\n            case cc.macro.KEY.p:\n                this.isKeyP = true;\n                break;\n            case cc.macro.KEY.k:\n                this.isK= true;\n                break;\n            case cc.macro.KEY.l:\n                this.isL = true;\n                break;\n            case cc.macro.KEY.m:\n                this.isM = true;\n                break;\n            case cc.macro.KEY.n:\n                this.isN = true;\n                break;\n        }\n    },\n\n    onKeyUp: function (event) {\n        switch(event.keyCode) {\n            case cc.macro.KEY.a:\n                this.isKeyA = false;\n                break;\n            case cc.macro.KEY.d:\n                this.isKeyD = false;\n                break;\n            case cc.macro.KEY.w:\n                this.isKeyW = false;\n                break;\n            case cc.macro.KEY.s:\n                this.isKeyS = false;\n                break;\n            case cc.macro.KEY.o:\n                this.isKeyO = false;\n                break;\n            case cc.macro.KEY.p:\n                this.isKeyP = false;\n                break;\n            case cc.macro.KEY.k:\n                this.isK= false;\n                break;\n            case cc.macro.KEY.l:\n                this.isL = false;\n                break;\n            case cc.macro.KEY.u:\n                console.log(this.cameras[0].node.position, this.cameras[0].node.rotationX,this.cameras[0].fov);\n                break;\n            case cc.macro.KEY.m:\n                this.isM = false;\n                break;\n            case cc.macro.KEY.n:\n                this.isN = false;\n                break;\n        }\n    }\n});","let CamAdjust = cc.Class({\n    extends: cc.Component,\n\n    properties: {\n        cameras: [cc.Camera],\n        sceneNodes: [cc.Node],\n        infos: null,\n        vx: 0,\n        vy: 0,\n        ax: 0.5,\n        maxV: 1,\n\n        /*rotX:0,\n        rotY:0,\n\n        posX: 0, \n        posY: 0,*/\n\n        rotRangeX: 10,\n        rotRangeY: 10,\n\n        //moveRangeX: 50,\n        //moveRangeY: 10,\n\n        screenWidth: 0,\n        screenHeight: 0,\n        designResolutionHeight: 0,\n        designResolutionHeight_2: 0,\n    },\n\n    onLoad: function () {\n        this.screenWidth = cc.view.getDesignResolutionSize().height / cc.view.getCanvasSize().height * cc.view.getCanvasSize().width;\n        this.screenHeight = cc.view.getDesignResolutionSize().width / cc.view.getCanvasSize().width * cc.view.getCanvasSize().height;\n        \n\n        this.designResolutionHeight = cc.view.getDesignResolutionSize().height;\n        this.designResolutionHeight_2 = cc.view.getDesignResolutionSize().height / 2;\n        /*this.rotX =  this.cameras[0].node.eulerAngles.x;\n        this.rotY =  this.cameras[0].node.eulerAngles.y;\n\n        this.posX = this.cameras[0].node.position.x;\n        this.posY = this.cameras[0].node.position.y;\n        //console.log(this.rotX, this.rotY);*/\n        this.infos = [];\n        for (let i = 0; i < this.sceneNodes.length; i++) {\n            let info = { x: this.sceneNodes[i].eulerAngles.x, y: this.sceneNodes[i].eulerAngles.y };\n            this.infos.push(info);\n        }\n\n        this.node.on(cc.Node.EventType.TOUCH_MOVE, this.onTouchMove, this);\n        this.node.on(cc.Node.EventType.MOUSE_MOVE, this.onMouseMove, this);\n\n\n    },\n\n    onDestroy: function () {\n        this.node.off(cc.Node.EventType.TOUCH_MOVE, this.onTouchMove, this);\n        this.node.on(cc.Node.EventType.MOUSE_MOVE, this.onMouseMove, this);\n    },\n\n    onTouchMove: function (evt) {\n        // this.onMouseMove(evt);\n    },\n\n    onMouseMove: function (evt) {\n        // console.log(this.screenWidth/2 - evt._x, this.screenWidth/2);\n        let targetY = (this.screenWidth / 2 - evt._x) / (this.screenWidth / 2) * this.rotRangeY;\n        let targetX = (this.screenHeight / 2 - evt._y) / (this.screenHeight / 2) * this.rotRangeX ;\n\n        //let targetMoveX = (this.screenWidth/2 - evt._x)/ (this.screenWidth/2) * this.moveRangeX + this.posX;\n        //let targetMoveY = ( evt._y - this.designResolutionHeight_2 ) / this.designResolutionHeight_2 *this.moveRangeY + this.posY;\n\n        // console.log(\"target\", targetX, targetY);\n        let currentX = this.sceneNodes[0].eulerAngles.x;\n        let currentY = this.sceneNodes[0].eulerAngles.y;\n        console.log(\"currentX\", currentX, \"currentY\", currentY);\n\n        let timeY = Math.abs(targetY - currentY) / this.rotRangeY;\n        let timeX = Math.abs(targetX - currentX) / this.rotRangeX;\n        //console.log('time', timeX, timeY);\n\n        for (let i = 0; i < this.sceneNodes.length; i++) {\n\n            let rotate3DTo = cc.rotate3DTo(Math.max(timeX, timeY), cc.v3(targetX + this.infos[i].x, targetY + this.infos[i].y, 0));\n            // let move3DTo = cc.moveTo(1, cc.v3(targetMoveX, targetMoveY, 0));\n                console.log(targetX, targetY);\n            // this.cameras[i].node.stopAllActions();\n            // this.cameras[i].node.runAction(cc.spawn(rotate3DTo, move3DTo));\n\n\n            this.sceneNodes[i].stopAllActions();\n            this.sceneNodes[i].runAction(rotate3DTo);\n\n        }\n\n    },\n});","cc.Class({\n    extends: cc.Component,\n\n    properties: {\n        stage: cc.Node,\n        eye: cc.Node,\n        isLeft: cc.Boolean\n    },\n\n    onLoad() {\n        this.randX = 8;\n        this.randY = 1.5;\n        // this.stage.on(cc.Node.EventType.TOUCH_MOVE, this.touchMoveHandler, this);\n        // this.stage.on(cc.Node.EventType.MOUSE_MOVE, this.mouseMoveHandler, this);\n    },\n\n    touchMoveHandler(evt) {\n        //console.log(evt);\n    },\n\n    mouseMoveHandler(evt) {\n\n        let worldPos = this.stage.convertToWorldSpaceAR(cc.v2(evt.getLocationX(), evt.getLocationY()));\n        //console.log(\"world\",worldPos.x, worldPos.y);\n        worldPos = cc.v2(evt.getLocationX(), evt.getLocationY());\n        let pos = this.node.convertToNodeSpaceAR(worldPos);\n        //console.log(pos.x , pos.y);\n\n        //this.eye.setPosition(pos.x, pos.y);\n\n        let len = 0;\n        let tan = 0;\n        let ctan = 0;\n\n        let posX = 0;\n        let posY = 0;\n\n        if (pos.x != 0 && pos.y != 0) {\n\n            let mouseLen2 = Math.pow(pos.x, 2) * Math.pow(pos.y, 2) / (Math.pow(pos.x, 2) + Math.pow(pos.y, 2));\n            if (mouseLen2 > Math.pow(150, 2)) {\n                posX = 0;\n                posY = 0;\n\n            }\n            else {\n                let factor = Math.min(Math.pow(mouseLen2, 0.5) / 40, 1);\n                //factor = Math.pow(factor, 2);\n                if (this.isLeft) {\n                    pos.x -= 40 * factor;\n                }\n                else {\n                    pos.x += 40 * factor;\n                }\n                if (pos.x < 0) {\n                    pos.x = Math.max(pos.x, -8);\n                }\n                else {\n                    pos.x = Math.min(pos.x, 8);\n                }\n                if (pos.y < 0) {\n                    pos.y = Math.max(pos.y, -2.5);\n                }\n                else {\n                    pos.y = Math.min(pos.y, 2.5);\n                }\n                let len2 = Math.pow(pos.x, 2) * Math.pow(pos.y, 2) / (Math.pow(pos.x, 2) + Math.pow(pos.y, 2));\n                len = Math.pow(len2, 0.5);\n\n                tan = pos.y / len;\n                ctan = pos.x / len;\n\n                posX = len * ctan;\n                posY = len * tan;\n\n            }\n\n        }\n\n        this.eye.setPosition(posX, posY);\n        //console.log(\"set pos\", posX, posY);\n\n    }\n})","let MusicToggle = require(\"MusicToggle\");\nlet BodyAnim = require(\"BodyAnim\");\n\ncc.Class({\n    extends: cc.Component,\n\n    properties: {\n        editBox: cc.EditBox,\n        audioID: -1,\n        mouthNode: cc.Node,\n        mouthIsReset: true,\n        historyObjects: [],\n        sendButton: cc.Node,\n\n        balloonPrefab: cc.Prefab,\n        balloonNode: cc.Node,\n\n        introSound: {\n            type: cc.AudioClip,\n            default: null\n        },\n\n        music: MusicToggle,\n        blockerNode: cc.Node,\n        idleMouthTimeout: -1,\n        bodyAnim: BodyAnim,\n        headAnim: cc.Animation,\n\n        initialMsgJSON: null,\n\n        introCameras: [cc.Camera],\n        furweeIntialized:false,\n\n        URL: \"http://40.121.137.102\"\n\n    },\n\n    start() {\n        this.blockerNode.active = true;\n    },\n\n    onLoad() {\n\n        let isLocalHost = false;\n        if (window.location.href.indexOf(\"localhost\") != -1 || window.location.href.indexOf(\"127.0.0.1\") != -1) {\n            isLocalHost = true;\n        }\n        console.log(\"isLocalHost\", isLocalHost);\n\n        /*\n        this.urlAddress = isLocalHost ? \"http://127.0.0.1:3000\" : \"http://13.115.222.147:3000\";\n        this.socket = new window.io(this.urlAddress, { transports: ['websocket', 'polling', 'flashsocket'] });\n\n        this.socket.on(\"connect\", this.handleConnect.bind(this));\n        this.socket.on(\"onTTSCompleted\", this.onTTSCompleted.bind(this));\n\n        return;\n\n*/\n        this.onTextLenChange(this.editBox.string);\n        this.startFurwee();\n\n    },\n\n    handleConnect() {\n        console.log('connected', this.socket.id);\n    },\n\n    startFurwee_backup() {\n\n\n        let msg = \"Hi, my name is Furwee. What's your name?\";\n        this.addBallon(msg, true);\n        //return;\n\n        this.audioInfo = [{ \"audio_offset_ms\": 50, \"viseme_id\": 0 }, { \"audio_offset_ms\": 100, \"viseme_id\": 12 }, { \"audio_offset_ms\": 237.5, \"viseme_id\": 11 }, { \"audio_offset_ms\": 475, \"viseme_id\": 0 }, { \"audio_offset_ms\": 650, \"viseme_id\": 21 }, { \"audio_offset_ms\": 687.5, \"viseme_id\": 11 }, { \"audio_offset_ms\": 762.5, \"viseme_id\": 19 }, { \"audio_offset_ms\": 850, \"viseme_id\": 4 }, { \"audio_offset_ms\": 893.75, \"viseme_id\": 6 }, { \"audio_offset_ms\": 937.5, \"viseme_id\": 21 }, { \"audio_offset_ms\": 1000, \"viseme_id\": 6 }, { \"audio_offset_ms\": 1062.5, \"viseme_id\": 15 }, { \"audio_offset_ms\": 1150, \"viseme_id\": 18 }, { \"audio_offset_ms\": 1212.5, \"viseme_id\": 5 }, { \"audio_offset_ms\": 1287.5, \"viseme_id\": 13 }, { \"audio_offset_ms\": 1350, \"viseme_id\": 7 }, { \"audio_offset_ms\": 1400, \"viseme_id\": 6 }, { \"audio_offset_ms\": 1662, \"viseme_id\": 0 }, { \"audio_offset_ms\": 2425, \"viseme_id\": 0 }, { \"audio_offset_ms\": 2475, \"viseme_id\": 7 }, { \"audio_offset_ms\": 2575, \"viseme_id\": 1 }, { \"audio_offset_ms\": 2637.5, \"viseme_id\": 19 }, { \"audio_offset_ms\": 2687.5, \"viseme_id\": 15 }, { \"audio_offset_ms\": 2737.5, \"viseme_id\": 6 }, { \"audio_offset_ms\": 2787.5, \"viseme_id\": 3 }, { \"audio_offset_ms\": 2825, \"viseme_id\": 13 }, { \"audio_offset_ms\": 2862.5, \"viseme_id\": 19 }, { \"audio_offset_ms\": 2925, \"viseme_id\": 4 }, { \"audio_offset_ms\": 3025, \"viseme_id\": 6 }, { \"audio_offset_ms\": 3125, \"viseme_id\": 21 }, { \"audio_offset_ms\": 3300, \"viseme_id\": 0 }]\n        this.audioID = cc.audioEngine.play(this.introSound);\n        this.audioOffset = 0;\n        this.updateMouth();\n\n        this.bodyAnim.playIntro();\n        this.headAnim.play();\n\n        cc.audioEngine.setFinishCallback(this.audioID, function () {\n            this.audioID = -1;\n            this.mouthIsReset = false;\n        }.bind(this));\n\n    },\n\n    startFurwee() {\n        this.headAnim.play();\n        this.bodyAnim.play();\n\n        let that = this;\n        let xhr = new XMLHttpRequest();\n        let requestURL = this.URL + \"/initial-message/\";\n\n        xhr.onreadystatechange = function () {\n            if (xhr.readyState == XMLHttpRequest.DONE) {\n                if (xhr.status == 200) {\n\n                    that.initialMsgJSON = JSON.parse(xhr.responseText);\n                    if (!that.tryToStartFurweeIntro()) {\n                        //preload sound\n                        let remoteUrl = that.initialMsgJSON.audio_file_link;\n                        cc.loader.load({ url: remoteUrl, type: 'wav' });\n                    }\n                }\n            }\n        }\n        xhr.open('GET', requestURL, true);\n        xhr.setRequestHeader('Content-type', 'application/json');\n        xhr.send(\"\");\n    },\n\n    tryToStartFurweeIntro() {\n        if (this.blockerNode.active) {\n            return false;\n        }\n        if (!this.initialMsgJSON) {\n            return false;\n        }\n\n        if(this.furweeIntialized){\n            return false;\n        }\n        this.furweeIntialized = true;\n\n        this.onTTSCompleted(this.initialMsgJSON, function () {\n\n            this.addBallon(this.initialMsgJSON.reply, true);\n            this.bodyAnim.playIntro();\n\n        }.bind(this));\n\n        this.historyObjects.push({ \"index\": this.historyObjects.length, \"reply\": this.initialMsgJSON.reply, \"message\": this.initialMsgJSON.message });\n        return true;\n    },\n\n\n    onTTSCompleted(info, soundloadedHandler = null) {\n        if (!info) {\n            return;\n        }\n\n        this.audioInfo = info.lip_sync_animation;\n\n        let remoteUrl = info.audio_file_link;\n        cc.loader.load({ url: remoteUrl, type: 'wav' }, function (err, res) {\n            // Use texture to create sprite frame\n            this.audioID = cc.audioEngine.play(res);\n            this.audioOffset = 0;\n            this.stopIdleMouth();\n            this.updateMouth();\n\n            if (soundloadedHandler) {\n                soundloadedHandler();\n            }\n\n            cc.audioEngine.setFinishCallback(this.audioID, function () {\n                this.audioID = -1;\n                this.mouthIsReset = false;\n            }.bind(this));\n        }.bind(this));\n    },\n\n    didReturnHandler() {\n        this.sendHandler();\n        setTimeout(function () {\n            this.editBox.focus();\n        }.bind(this), 0);\n    },\n\n\n    sendHandler() {\n        let sendText = this.editBox.string;\n        if (sendText.trim().length == 0) {\n            return;\n        }\n\n        /* this.socket.emit(\"tts\", sendText);\n         return;\n */\n\n        this.addBallon(sendText, false);\n        this.editBox.string = \"\";\n        this.editBox.focus();\n\n        this.onTextLenChange(this.editBox.string);\n\n        let that = this;\n        let xhr = new XMLHttpRequest();\n\n        let requestURL = this.URL + \"/messages/\";\n        xhr.onreadystatechange = function () {\n            if (xhr.readyState == XMLHttpRequest.DONE) {\n                if (xhr.status == 200) {\n                    let json = JSON.parse(xhr.responseText);\n                    that.onTTSCompleted(json);\n\n                    that.historyObjects.push({ \"index\": that.historyObjects.length, \"reply\": json.reply, \"message\": json.message });\n\n                    that.addBallon(json.reply, true);\n                }\n            }\n        }\n        let params = JSON.stringify({ \"message\": sendText, history: this.historyObjects });\n        xhr.open('POST', requestURL, true);\n        xhr.setRequestHeader('Content-type', 'application/json');\n        xhr.send(params);\n\n\n        let xhr2 = new XMLHttpRequest();\n        let requestURL2 = this.URL + \"/emotion/\";\n        xhr2.onreadystatechange = function () {\n            if (xhr2.readyState == XMLHttpRequest.DONE) {\n                if (xhr2.status == 200) {\n                    console.log(xhr2.responseText);\n                }\n            }\n        }\n        let params2 = JSON.stringify({ \"message\": sendText });\n        xhr2.open('POST', requestURL2, true);\n        xhr2.setRequestHeader('Content-type', 'application/json');\n        xhr2.send(params2);\n    },\n\n    updateMouth() {\n        //audio_offset_ms: 1162.5, viseme_id: 11}\n        let id = this.audioInfo[this.audioOffset].viseme_id;\n\n        let node = this.mouthNode.getChildByName(\"mouth_\" + id);\n        if (node) {\n            this.clearMouth();\n            node.active = true;\n        }\n    },\n\n    update(dt) {\n        if (this.audioID != -1) {\n            let time = cc.audioEngine.getCurrentTime(this.audioID)\n\n            while (this.audioInfo.length > this.audioOffset\n                && (this.audioInfo[this.audioOffset].audio_offset_ms < time * 1000 + 15)) {\n                // && ((this.audioOffset + 1 >= this.audioInfo.length) || (Math.abs(this.audioInfo[this.audioOffset ].audioOffset - time* 1000 ) > (this.audioInfo[this.audioOffset +1].audioOffset - time* 1000 )))){\n                this.updateMouth();\n                this.audioOffset += 1;\n\n            }\n        }\n        else {\n            if (!this.mouthIsReset) {\n                this.mouthIsReset = true;\n                this.clearMouth();\n                this.mouthNode.getChildByName(\"mouth_0\").active = true;\n                this.startIdleMouth();\n            }\n        }\n    },\n\n    onTextLenChange(textContent) {\n        this.sendButton.active = textContent.length != 0\n    },\n\n    addBallon(message, isFurwee) {\n        for (var i = 0; i < this.balloonNode.children.length; ++i) {\n            this.balloonNode.children[i].getComponent(\"Ballon\").step();\n        }\n\n        let balloon = cc.instantiate(this.balloonPrefab);\n        balloon.getComponent('Ballon').init(message, isFurwee);\n        this.balloonNode.addChild(balloon);\n\n\n    },\n\n    blockClickHandler() {\n        this.blockerNode.active = false;\n        this.music.initialize();\n        //this.tryToStartFurweeIntro();\n        this.introCameraAnim();\n    },\n\n    introCameraAnim() {\n        for (let i = 0; i < this.introCameras.length; i++) {\n            this.introCameras[i].getComponent(cc.Animation).play();\n        }\n\n        setTimeout(this.tryToStartFurweeIntro.bind(this), 2000);\n    },\n\n    clearMouth() {\n        for (let i = 0; i <= 21; i++) {\n            let node2 = this.mouthNode.getChildByName(\"mouth_\" + i);\n            node2.active = false;\n        }\n\n        for (let i = 0; i < 2; i++) {\n            let node2 = this.mouthNode.getChildByName(\"idle_\" + i);\n            node2.active = false;\n        }\n    },\n\n    startIdleMouth() {\n        this.setIdleMouth();\n    },\n\n    setIdleMouth() {\n        clearTimeout(this.idleMouthTimeout);\n        this.idleMouthTimeout = -1;\n\n        this.clearMouth();\n        let idle = Math.floor(Math.random() * 2);\n        this.mouthNode.getChildByName(\"idle_\" + idle).active = true;\n\n        setTimeout(this.setIdleMouth.bind(this), 3000 * Math.random() + 3000);\n    },\n\n    stopIdleMouth() {\n        clearTimeout(this.idleMouthTimeout);\n        this.idleMouthTimeout = -1;\n    },\n\n});\n","// Learn cc.Class:\n//  - https://docs.cocos.com/creator/manual/en/scripting/class.html\n// Learn Attribute:\n//  - https://docs.cocos.com/creator/manual/en/scripting/reference/attributes.html\n// Learn life-cycle callbacks:\n//  - https://docs.cocos.com/creator/manual/en/scripting/life-cycle-callbacks.html\n\ncc.Class({\n    extends: cc.Component,\n\n    properties: {\n        progressBar:cc.ProgressBar,\n    },\n\n    // LIFE-CYCLE CALLBACKS:\n\n    // onLoad () {},\n\n    onLoad () {\n        cc.director.preloadScene(\"game\", this.onProgress.bind(this), this.onComplete.bind(this));\n    },\n\n    onProgress(completedCount, totalCount){\n        this.progressBar.progress = completedCount/totalCount;\n    },\n\n    onComplete(error){\n        if(!error){\n            cc.director.loadScene(\"game\");\n        }\n\n    }\n\n    \n});\n","let MusicToggle = cc.Class({\n    extends: cc.Component,\n\n    properties: {\n        onNode: cc.Node,\n        offNode: cc.Node,\n        hintNode: cc.Node,\n        hintText: cc.Label,\n        audioId: null,\n        music: {\n            type: cc.AudioClip,\n            default: null\n        },\n        anim: cc.Animation\n    },\n\n    initialize() {\n        this.isMusicOn = cc.sys.localStorage.getItem(\"music\");\n        if (this.isMusicOn == null) {\n            this.isMusicOn = true;\n        }\n\n        if (this.isMusicOn) {\n            this.toggleOn();\n            /*setTimeout(function(){ \n                cc.sys.__audioSupport.context.resume();\n                cc.game.canvas.dispatchEvent(new Event(\"mousedown\"))\n            }, 3000);*/\n        }\n        else {\n            this.toggleOff();\n        }\n\n\n\n        // this.node.on(\"mouseOver\")\n\n    },\n\n    toggleOver() {\n        this.hintNode.active = true;\n    },\n\n    toggleOut() {\n        this.hintNode.active = false;\n    },\n\n\n    toggleOff() {\n        this.onNode.active = true;\n        this.offNode.active = false;\n        this.hintText.string = \"Turn Volumn On\";\n\n        if (this.audioId != null) {\n            cc.audioEngine.pauseMusic();\n        }\n\n\n    },\n\n    toggleOn() {\n        this.offNode.active = true;\n        this.onNode.active = false;\n        this.hintText.string = \"Turn Volumn Off\";\n\n        if (!this.audioId) {\n            this.audioId = cc.audioEngine.playMusic(this.music, true);\n        }\n        else {\n            cc.audioEngine.resumeMusic();\n        }\n    }\n\n});"],"file":"project.dev.js"}